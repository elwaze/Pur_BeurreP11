language: python
python:
  - '3.7'

before_script:
  - pip install -r requirements.txt
  - pip install mailcatcher
  - smtp://127.0.0.1:1025
  - coverage erase

env: DJANGO_SETTINGS_MODULE="pur_beurre.settings.test_settings"

services:
  - postgresql

script:
  - coverage run ./manage.py test tests.apps --settings=pur_beurre.settings.test_settings

# safelist
branches:
  only:
    - staging
